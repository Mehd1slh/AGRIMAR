<!-- {% extends "layout.html" %} {% block content %}
<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous" />
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='main.css')}}" />
</head>
<body>
  <div class="container">
    <div class="row justify-content-center align-items-start">
      <div class="col-md-4 card">
        <div class="card-header msg_head">
          <div class="d-flex bd-highlight">
            <div class="chat-history">
              <div class="user_info">
                <h2>Chat History</h2>
                <ul id="chatList"></ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-8">
        <div class="card">
          <div class="card-header msg_head">
            <div class="d-flex bd-highlight">
              <div class="user_info">
                <h2 id="chatTitle">Select a chat to view</h2>
              </div>
            </div>
          </div>
          <div id="messageFormeight" class="card-body msg_card_body"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const chatList = document.getElementById("chatList");
    const chatTitle = document.getElementById("chatTitle");
    const messageFormeight = document.getElementById("messageFormeight");
    var chats = { chats };

    // Populate chat list
    chats.forEach((conversation, index) => {
      const li = document.createElement("li");
      li.textContent = conversation.title;
      li.addEventListener("click", () => loadChat(index));
      chatList.appendChild(li);
    });

    function loadChat(index) {
      const chat = chats[index];
      chatTitle.textContent = chat.title;
      messageFormeight.innerHTML = ""; // Clear previous messages

      // Append messages to the chat UI
      chat.messages.forEach((message) => {
        const messageDiv = document.createElement("div");
        if (message.sender === "assistant") {
          messageDiv.classList.add("d-flex", "justify-content-start", "mb-4");
          messageDiv.innerHTML = `
                <div class="msg_cotainer">${message.content}<span class="msg_time_send">${message.time}</span></div>
                <div class="img_cont_msg">
                  <img src="/static/chatbot icon.jpg" class="rounded-circle user_img_msg">
                </div>`;
        } else {
          messageDiv.classList.add("d-flex", "justify-content-end", "mb-4");
          messageDiv.innerHTML = `
                <div class="img_cont_msg">
                  <img src="/static/chatbot icon.jpg" class="rounded-circle user_img_msg">
                </div>
                <div class="msg_cotainer_send">${message.content}<span class="msg_time">${message.time}</span></div>`;
        }
        messageFormeight.appendChild(messageDiv);
        $("#messageFormeight").css("height", "auto");
      });
    }

    // Initially load the first chat
    if (userChats.length > 0) {
      loadChat(0);
    }
  </script>
</body>
{% endblock content %} -->
